<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="EN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<title>HDF 1.1 (draft)</title>
		<link rel="stylesheet" type="text/css" href="hndfspec.css"/>
		<!--link rel="stylesheet" type="text/css" href="syntax.css"/-->

	</head>
	<body>
		<div class="head">
			<p><h1><a name="title" id="title"/>HDF Data Format 1.1</h1>
			<!--<h3>Working draft 2014-07-23</h3></p>-->
		</div>
		<hr/>
		
		<div class="state">
			<h2><a name="state-of-document" id="state-of-document">Status of this Document</a></h2>
			<p>
				This document is not an official specification. Its purpose is to provide information on how to handle HDF documents. <br/>This document is incomplete, and missing several key features.
				<!-- This document is an early draft document. It may be updated, replaced or obsoleted at any time. It should be treated as none other than work in progress. -->
			</p>
		</div>
		<div class="abstract">
			<h2><a name="contents" id="contents"/>Abstract</h2> 
			<p class="abstract">
				HDF (formerly HNDF) is a human-readable data serialization format, designed for use within 'hrengin' game engine. <!-- This specification provides full information necessary to create and read HDF documents.-->
			</p>
		</div>
		<hr/>
		<div class="toc">
			<h2><a name="contents" id="contents"/>Table of Contents</h2> 
			<p class="toc">
				<dl>
					<dt>
						<span class="section">
							1. <a href="#section-intro">Introduction</a>
						</span>
					</dt>
					<dd>
						1.1. <a href="#section-relation">Relation to other languages</a>
					</dd>
					<dd>
						1.2. <a href="#section-terminology">Terminology</a>
					</dd>
					<dt>
						<span class="section">
							2. <a href="#section-characters">Characters</a>
						</span>
					</dt>
					<dd>
						2.1. <a href="#section-structure">Character set</a>
					</dd>
					<dd>
						2.2. <a href="#section-names">Names</a>
					</dd>
					<dd>
						2.3. <a href="#section-whitespace">White space</a>
					</dd>
					<dd>
						2.4. <a href="#section-lb">Line breaks</a>
					</dd>
					<dd>
						2.5. <a href="#section-strings">Strings</a>
					</dd>
					<dt>
						<span class="section">
							3. <a href="#section-document">HDF document</a>
						</span>
					</dt>
					<dd>
						3.1. <a href="#section-structure">Overall structure</a>
					</dd>
					<dd>
						3.2. <a href="#section-nodes">Nodes</a>
					</dd>
					<dd>
						3.3. <a href="#section-values">Values</a>
					</dd>
					<dt>
						<span class="section">
							4. <a href="#section-typing">Typing</a>
						</span>
					</dt>
				</dl>
			</p>
		</div>
		<div class="book">
			<p><h2><a name="section-intro" id="section-intro"/>1. Introduction</h2> 
			<p>HDF Data Format (or hrengin Data Format) is text-based data serialization format. It designed to be used specifically within 'hrengin' game engine, and to be easily read by human.</p>	
			
			<p>Another design goal for HDF is to be easy to implement and process. </p>
			
			<p>Although HDF is designed primarily for use  within 'hrengin' game engine, it is designed with possibility for general use in mind. </p>
			
			<p>The language is designed to be easy to implement, easy to process and use, and easy to create by a human. It is also designed to be extensible, lightweight, simple and concise.</p>
			
			<p><h3><a name="section-relation" id="section-relation"/>1.1. Relation to other languages</h2> </p>
			<p>HDF is designed for narrow scope of use as a data serialization language. It is not based on any other language, though is inspired by some other languages, most notably ZenGin Archive and XML.</p>
		</div>
		<div>
			<p><h2><a name="section-char" id="section-char"/>2. Characters</h2>
			<p><h3><a name="section-charset" id="section-charset"/>2.1. Character set</h2>
			<p>The exact character set is yet to be determined.</p>
			<p><h3><a name="section-names" id="section-name"/>2.2. Names</h2>
			<p><span class="grammar">name</span> is a sequence of characters. The first character must be a <span class="grammar">name_first</span>, and the following characters are <span class="grammar">name_char</span>.</p>
			<p class="grammar"><a name="g-name" id="g-name"/>name ::= name_first name_char* </p>
			<p class="grammar"><a name="g-name-first" id="g-name-first"/>name_first ::= [A-Z] | [a-z] </p>
			<p class="grammar"><a name="g-name-char" id="g-name-char"/>name_char ::= [A-Z] | [a-z] | '-' | '_' </p>
			<p><h3><a name="section-whitespace" id="section-whitespace"/>2.3. White space</h3></p>
			<p>White space consists of one or more spaces and tabs. </p>
			<p class="grammar"><a name="g-whitespace" id="g-whitespace"/>ws_char ::= #xA | #x20 </p>
			<p class="grammar"><a name="g-whitespace" id="g-whitespace"/>ws ::= ws_char+ </p>
			<p class="note">Note: this definition does not yet account for the unicode range characters.</p>
			
			<p><h3><a name="section-lb" id="section-lb"/>2.4. Line breaks</h3></p>
			<p>Line break is line feed character or a carriage return followed by line feed character. </p>
			
			<p class="grammar">line_break ::= #xA | (#xA #xD) </p>
			
			<p>In addition to whitespace we add line breaks. We do this because line breaks also selve as a separators. </p>
			<p class="grammar">s ::= (ws_char | line_break)+ </p>
			
			<p><h3><a name="section-strings" id="section-strings"/>2.5. Strings</h3></p>
			<p><span class="grammar">string</span> is a sequence of characters enclosed within <span class="grammar">'"'</span> (quotation marks) characters.</p>
			
			<p class="grammar"><a name="g-string" id="g-string"/>string ::= '"' char* '"' </p>
			
			<p><h4><a name="sub-escape" id="sub-escape"/>2.5.1. Escape sequences</h4></p>
			
			
			
			
			<p><h2><a name="section-document" id="section-document"/>3. HDF document</h2> 
			<p><h2><a name="section-structure" id="section-structure"/>3.1. Structure</h2> 
			<p class="definition">HDF document is composed of units called '<span class="grammar">node</span>', and must contain at least one of those.</p> 
			
			<p>Overall structure of a document can be defined as:</p>
			
			<p class="grammar"><a name="g-doc" id="g-doc"/>document ::= header? node+</p>
			
			<p>This definition suggests following:
			<ol>
				<li> Document may contain <a href="#g-header">header</a>, preceding all other data. </li>
				<li> Document contains one or more <a href="#g-node">nodes</a>. </li>
			</ol>
			</p>
			
			<p>Example of a simplest document:</p>
			
			<code id="example1">[root-node]</code>
			
			
			<p><h3><a name="section-nodes" id="section-nodes"/>3.2. Nodes</h2> 
			<p class="definition"><span class="grammar">node</span> is a basic unit of a document. Each <span class="grammar">node</span> is delimited by <span class="grammar">node_start</span> and <span class="grammar">node_end</span>. Each <span class="grammar">node</span> may have a <span class="grammar">node_type</span>, followed by <span class="grammar">name</span> or an empty name.</p>
			
			<p class="grammar"><a name="g-node-start" id="g-node-start"/>node_start ::= '[' node_type? name s </p>
			<p class="grammar"><a name="g-node-end" id="g-node-end"/>node_end ::= s? ']' s? </p>
			
			<p class="grammar"><a name="g-node" id="g-node"><table class="grammar">
				<tr><td>node</td><td> ::= </td><td>node_start node_content? node_end</td></tr>
			</table></p>
			
			<p class="definition"> Each node may contaion <span class="grammar">value</span> or other <span class="grammar">nodes</span>. </p>
			
			<p class="grammar"><a name="g-node" id="g-node"/> node_content ::= value-value | value-node | node-value | node-node </p>
			<p class="grammar"><a name="g-object" id="g-object"/> value-value ::= value (separator value-value | value-node)? s? </p>
			<p class="grammar"><a name="g-object" id="g-object"/> value-node ::= value (separator? node-value | node-node)? s? </p>
			<p class="grammar"><a name="g-object" id="g-object"/> node-value ::= node (separator? value-value | value-node)? s? </p>
			<p class="grammar"><a name="g-object" id="g-object"/> node-node ::= node (separator? node-value | node-value)? s? </p>
			<p class="grammar"><a name="g-separator" id="g-separator"/>separator ::= ws? ';' | line_break s? </p>
			
			<p>
			</p>
			
			<p class="definition">An empty node is a node without node_content.</p>
			
			<p>An example HDF document, containing a node with subnode, which has two empty subnodes.</p>
			<pre id="example3">
<span class="node">[node
  <span class="node">[subnode
    <span class="node">[subsubnode1]</span> <span class="node">[subsubnode2]</span>
  ]</span>
]</span>
			</pre>

			<p><h3><a name="section-values" id="section-values"/>3.3. Values</h2> 
			<p></p>
			
			<p class="grammar">value ::= name ws? '=' ws? (type ws? ':')? ws? data+ </p>
			<p class="grammar">type ::= name</p>
			<p class="grammar">data ::= string | number | name</p>
			
			<p>An example HDF document, describing a geometric model.</p>
		<pre id="example3">
[model 
  [shapes 
    [shape 
      type = sphere 
      radius = float:5.0 
    ] 
    [shape 
      type = sphere 
      radius = float:2.5 
      offset = float:0.0 5.0 0.0&nbsp;
    ] 
  ] 
]
</pre>

		<p>A diagram of the document, showing symbols.</p>
		<p>Legend: <span class="ws">white-space</span> <span class="node">node</span> <span class="value">value</span> <span class="type">type </span> <span class="name">name</span>  <span class="number">number</span> <span class="separator">separator </span></p>
			<pre id="example3">
[<span class="name">model</span><span class="ws"> </span>
<span class="ws">··</span>[<span class="name">shapes</span><span class="ws"> </span>
<span class="ws">····</span>[<span class="name">shape</span><span class="ws"> </span>
<span class="ws">······</span><span class="value"><span class="name">type</span><span class="ws">·</span>=<span class="ws">·</span><span class="name">sphere</span></span><span class="separator"> </span>
<span class="ws">······</span><span class="value"><span class="name">radius</span><span class="ws">·</span>=<span class="ws">·</span><span class="type">float</span>:<span class="number">5.0</span></span><span class="separator"> </span>
<span class="ws">····</span>]<span class="ws"> </span>
<span class="ws">····</span>[<span class="name">shape</span><span class="ws"> </span>
<span class="ws">······</span><span class="value"><span class="name">type</span><span class="ws">·</span>=<span class="ws">·</span><span class="name">sphere</span></span><span class="separator"> </span>
<span class="ws">······</span><span class="value"><span class="name">radius</span><span class="ws">·</span>=<span class="ws">·</span><span class="type">float</span>:<span class="number">2.5</span></span><span class="separator"> </span>
<span class="ws">······</span><span class="value"><span class="name">offset</span><span class="ws">·</span>=<span class="ws">·</span><span class="type">float</span>:<span class="number">0.0</span><span class="ws">·</span><span class="number">5.0</span><span class="ws">·</span><span class="number">0.0</span></span><span class="separator">&nbsp;</span>
<span class="ws">····</span>]<span class="ws"> </span>
<span class="ws">··</span>]<span class="ws"> </span>
]
</pre>
		<p>A diagram of the document with same data, but with minimum whitespace.</p>
<pre id="example3">
<span class="node">[<span class="name">model</span>[<span class="name">shapes</span>[<span class="name">shape</span><span class="ws">·</span><span class="value"><span class="name">type</span>=<span class="name">sphere</span></span><span class="separator">;</span><span class="value"><span class="name">radius</span>=<span class="type">float</span>:<span class="number">5.0</span></span><span class="separator">;</span>][<span class="name">shape</span><span class="ws">·</span><span class="value"><span class="name">type</span>=<span class="name">sphere</span></span><span class="separator">;</span><span class="value"><span class="name">radius</span>=<span class="type">float</span>:<span class="number">2.5</span></span><span class="separator">;</span><span class="value"><span class="name">offset</span>=<span class="type">float</span>:<span class="number">0.0</span><span class="ws">·</span><span class="number">5.0</span><span class="ws">·</span><span class="number">0.0</span></span><span class="separator">;</span>]]]</span>
</pre>
		</div>
	</body>
</html>